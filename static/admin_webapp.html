<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>Telegram Web App</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
            overflow-x: hidden;
        }

        .minibar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #333;
            padding: 10px 0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .minibar-item {
            color: white;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            width: 20%;
            cursor: pointer;
            font-size: 12px;
            text-align: center;
        }

        .minibar-item.active {
            color: #0088cc;
        }

        .icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .content {
            padding: 20px;
            padding-bottom: 80px;
        }

        .add-button, .action-button {
            padding: 15px 30px;
            background: #0088cc;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            display: block;
            width: 100%;
            text-align: center;
        }

        .form-container, .edit-form-container {
            display: none;
            flex-direction: column;
            gap: 10px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .list-container {
            display: none;
            flex-direction: column;
            gap: 10px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        input, textarea, select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            width: 100%;
            box-sizing: border-box;
        }

        button {
            padding: 10px;
            background: #0088cc;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .dish-item {
            display: flex;
            background: white;
            border-radius: 15px;
            margin: 10px 0;
            padding: 10px;
            align-items: center;
        }

        .dish-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 10px;
            margin-right: 10px;
        }

        .dish-info {
            flex-grow: 1;
            font-size: 14px;
        }

        .send-button {
            padding: 15px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 0;
            width: 100%;
            text-align: center;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 10px;
            margin: 5px 0;
        }

        .orders-list {
        margin-top: 10px;
    }
    .order-item {
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-bottom: 10px;
        padding: 10px;
        background-color: #f9f9f9;
    }
    .order-header {
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .order-header span {
        color: #888;
    }
    .order-details {
        margin-top: 10px;
        padding-left: 10px;
    }
    .order-details ul {
        list-style-type: none;
        padding-left: 0;
    }
    .order-details li {
        margin-bottom: 5px;
    }

        @media (max-width: 600px) {
            .minibar-item {
                font-size: 10px;
            }
            .icon {
                font-size: 20px;
            }
            .dish-image {
                width: 80px;
                height: 80px;
            }
            .dish-info {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="content" id="content"></div>

    <div class="minibar">
        <div class="minibar-item active" onclick="showTab('add')">
            <span class="icon">+</span>
            <span>–î–æ–±–∞–≤–∏—Ç—å</span>
        </div>
        <div class="minibar-item" onclick="showTab('edit')">
            <span class="icon">‚úé</span>
            <span>–ò–∑–º–µ–Ω–∏—Ç—å</span>
        </div>
        <div class="minibar-item" onclick="showTab('stop')">
            <span class="icon">‚èπ</span>
            <span>–°—Ç–æ–ø-–ª–∏—Å—Ç</span>
        </div>
        <div class="minibar-item" onclick="showTab('delete')">
            <span class="icon">üóë</span>
            <span>–£–¥–∞–ª–∏—Ç—å</span>
        </div>
        <div class="minibar-item" onclick="showTab('history')">
            <span class="icon">üïí</span>
            <span>–ó–∞–∫–∞–∑—ã</span>
        </div>
    </div>
<script>
    let tg = window.Telegram.WebApp;
    let items = [];
    let stopList = [];
    let newlyAddedItems = [];
    let orders = [];
    let currentTab = 'add';
    const restaurantCode = 'BUHTA123';
    let apiUrl = `${window.location.origin}/api/menu/BUHTA123`;
    let ordersApiUrl = `${window.location.origin}/api/orders/BUHTA123`;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', async () => {
        if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
            tg.expand();
            tg.enableClosingConfirmation();
        }
        await fetchMenu();
        await fetchOrders();
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é
    async function fetchMenu() {
        try {
            console.log('–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é —Å:', apiUrl);
            const response = await fetch(apiUrl);
            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é: ${response.status} - ${errorText}`);
            }
            const data = await response.json();
            console.log('–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–µ–Ω—é:', data);

            items = [];
            stopList = [];
            for (const category in data) {
                data[category].forEach(item => {
                    items.push({ ...item, category });
                    if (item.in_stop_list) stopList.push(item.id);
                });
            }
            showTab(currentTab);
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é:', error);
            tg.showAlert(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–Ω—é: ${error.message}`);
        }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤
    async function fetchOrders() {
        try {
            console.log('–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤ —Å:', ordersApiUrl);
            const response = await fetch(ordersApiUrl);
            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤: ${response.status} - ${errorText}`);
            }
            orders = await response.json();
            console.log('–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã:', orders);
            if (currentTab === 'history') showTab('history');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤:', error);
            tg.showAlert(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤: ${error.message}`);
        }
    }

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    function showTab(tabName, event = null) {
        const itemsEl = document.querySelectorAll('.minibar-item');
        const content = document.getElementById('content');
        itemsEl.forEach(item => item.classList.remove('active'));

        if (event && event.currentTarget) {
            event.currentTarget.classList.add('active');
        } else {
            const defaultActiveTab = document.querySelector(`.minibar-item[onclick="showTab('${tabName}')"]`);
            if (defaultActiveTab) defaultActiveTab.classList.add('active');
        }

        currentTab = tabName;

        switch(tabName) {
            case 'add':
                content.innerHTML = renderAddTab();
                break;
            case 'edit':
                content.innerHTML = renderEditTab();
                break;
            case 'stop':
                content.innerHTML = renderStopTab();
                break;
            case 'delete':
                content.innerHTML = renderDeleteTab();
                break;
            case 'history':
                content.innerHTML = renderHistoryTab();
                break;
        }
        window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
    }

    function toggleForm(formId) {
        const form = document.getElementById(formId);
        form.style.display = form.style.display === 'flex' ? 'none' : 'flex';
    }

    async function addDish() {
        const dish = {
            name: document.getElementById('dishName').value,
            description: document.getElementById('dishDesc').value,
            weight: document.getElementById('dishWeight').value,
            image: document.getElementById('dishPhoto').value || null,
            portion_price: document.getElementById('dishPricePortion').value || null,
            bottle_price: document.getElementById('dishPriceBottle').value || null,
            category: document.getElementById('dishCategory').value || null,
            is_alcohol: document.getElementById('isAlcohol').checked,
            in_stop_list: false
        };

        if (dish.name && dish.description && dish.weight) {
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(dish)
                });
                if (response.ok) {
                    const addedDish = await response.json();
                    newlyAddedItems.push({ ...dish, id: addedDish.id || Date.now() });
                    await fetchMenu();
                    toggleForm('addForm');
                    showTab('add');
                    window.Telegram.WebApp.sendData(JSON.stringify({ action: 'add', ...dish }));
                    window.Telegram.WebApp.showAlert('–ë–ª—é–¥–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!');
                } else {
                    throw new Error(await response.text());
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥–∞:', error);
                window.Telegram.WebApp.showAlert('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–ª—é–¥–∞: ' + error.message);
            }
        } else {
            window.Telegram.WebApp.showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –≤–µ—Å!');
        }
    }

    function renderAddTab() {
        return `
            <button class="add-button" onclick="toggleForm('addForm')">–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
            <div class="form-container" id="addForm">
                <input type="text" id="dishName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞">
                <textarea id="dishDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
                <input type="text" id="dishWeight" placeholder="–í–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, 450 –º–ª –∏–ª–∏ 500 –≥—Ä)">
                <input type="text" id="dishPhoto" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ">
                <input type="number" id="dishPricePortion" placeholder="–¶–µ–Ω–∞ –∑–∞ –ø–æ—Ä—Ü–∏—é">
                <input type="number" id="dishPriceBottle" placeholder="–¶–µ–Ω–∞ –∑–∞ –±—É—Ç—ã–ª–∫—É">
                <select id="dishCategory">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                    ${Object.keys(fetchCategories()).map(cat => `<option value="${cat}">${cat}</option>`).join('')}
                </select>
                <label><input type="checkbox" id="isAlcohol"> –≠—Ç–æ –∞–ª–∫–æ–≥–æ–ª—å</label>
                <button onclick="addDish()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
            <div id="dishesList">
                ${newlyAddedItems.length > 0 ? newlyAddedItems.map(item => `
                    <div class="dish-item">
                        <img src="${item.image || 'https://via.placeholder.com/100x100?text=No+Image'}" class="dish-image">
                        <div class="dish-info">
                            <strong>${item.name}</strong><br>
                            ${item.category ? `–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${item.category}<br>` : ''}
                            ${item.description}<br>
                            –í–µ—Å: ${item.weight}<br>
                            ${item.portion_price ? `–¶–µ–Ω–∞ –ø–æ—Ä—Ü–∏–∏: ${item.portion_price}‚ÇΩ<br>` : ''}
                            ${item.bottle_price ? `–¶–µ–Ω–∞ –±—É—Ç—ã–ª–∫–∏: ${item.bottle_price}‚ÇΩ<br>` : ''}
                            ${item.is_alcohol ? '<span>–ê–ª–∫–æ–≥–æ–ª—å</span>' : ''}
                        </div>
                    </div>
                `).join('') : '<p>–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –±–ª—é–¥ –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏</p>'}
            </div>
        `;
    }

    function fetchCategories() {
        const categories = {};
        items.forEach(item => {
            if (item.category) categories[item.category] = true;
        });
        return categories;
    }

    function showEditForm(id) {
        const item = items.find(i => i.id === id);
        const editForm = document.getElementById('editForm');
        editForm.style.display = 'flex';
        editForm.innerHTML = `
            <input type="text" id="editDishName" value="${item.name}">
            <textarea id="editDishDesc">${item.description}</textarea>
            <input type="text" id="editDishWeight" value="${item.weight}">
            <input type="text" id="editDishPhoto" value="${item.image || ''}">
            <input type="number" id="editDishPricePortion" value="${item.portion_price || ''}">
            <input type="number" id="editDishPriceBottle" value="${item.bottle_price || ''}">
            <select id="editDishCategory">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                ${Object.keys(fetchCategories()).map(cat => `<option value="${cat}" ${item.category === cat ? 'selected' : ''}>${cat}</option>`).join('')}
            </select>
            <label><input type="checkbox" id="editIsAlcohol" ${item.is_alcohol ? 'checked' : ''}> –≠—Ç–æ –∞–ª–∫–æ–≥–æ–ª—å</label>
            <button onclick="saveEdit(${id})">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        `;
    }

    async function saveEdit(id) {
        const dish = {
            name: document.getElementById('editDishName').value,
            description: document.getElementById('editDishDesc').value,
            weight: document.getElementById('editDishWeight').value,
            image: document.getElementById('editDishPhoto').value || null,
            portion_price: document.getElementById('editDishPricePortion').value || null,
            bottle_price: document.getElementById('editDishPriceBottle').value || null,
            category: document.getElementById('editDishCategory').value || null,
            is_alcohol: document.getElementById('editIsAlcohol').checked,
            in_stop_list: items.find(i => i.id === id).in_stop_list
        };

        if (dish.name && dish.description && dish.weight) {
            try {
                const response = await fetch(`${apiUrl}/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(dish)
                });
                if (response.ok) {
                    await fetchMenu();
                    document.getElementById('editForm').style.display = 'none';
                    window.Telegram.WebApp.sendData(JSON.stringify({ action: 'update', ...dish }));
                    window.Telegram.WebApp.showAlert('–ë–ª—é–¥–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ!');
                } else {
                    throw new Error(await response.text());
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–ª—é–¥–∞:', error);
                window.Telegram.WebApp.showAlert('–û—à–∏–±–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–ª—é–¥–∞');
            }
        } else {
            window.Telegram.WebApp.showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ, –≤–µ—Å!');
        }
    }

    async function toggleStop(id) {
        const item = items.find(i => i.id === id);
        const newStopListStatus = !item.in_stop_list;
        try {
            const response = await fetch(`${apiUrl}/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ ...item, in_stop_list: newStopListStatus })
            });
            if (response.ok) {
                await fetchMenu();
                window.Telegram.WebApp.sendData(JSON.stringify({ action: 'stop_list', name: item.name }));
                window.Telegram.WebApp.showAlert(`–ë–ª—é–¥–æ ${newStopListStatus ? '–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤' : '—É–±—Ä–∞–Ω–æ –∏–∑'} —Å—Ç–æ–ø-–ª–∏—Å—Ç–∞!`);
            } else {
                throw new Error(await response.text());
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–æ–ø-–ª–∏—Å—Ç–∞:', error);
            window.Telegram.WebApp.showAlert('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–æ–ø-–ª–∏—Å—Ç–∞');
        }
    }

    async function deleteDish(id) {
        const item = items.find(i => i.id === id);
        try {
            const response = await fetch(`${apiUrl}/${id}`, {
                method: 'DELETE'
            });
            if (response.ok) {
                await fetchMenu();
                window.Telegram.WebApp.sendData(JSON.stringify({ action: 'delete', name: item.name }));
                window.Telegram.WebApp.showAlert('–ë–ª—é–¥–æ —É–¥–∞–ª–µ–Ω–æ!');
            } else {
                throw new Error(await response.text());
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –±–ª—é–¥–∞:', error);
            window.Telegram.WebApp.showAlert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –±–ª—é–¥–∞');
        }
    }

    function renderEditTab() {
        return `
            <button class="action-button" onclick="toggleForm('editList')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <div class="list-container" id="editList">
                ${items.length > 0 ? items.map((item) => `
                    <div class="list-item">
                        ${item.name}
                        <button onclick="showEditForm(${item.id})">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                    </div>
                `).join('') : '<p>–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç</p>'}
            </div>
            <div class="edit-form-container" id="editForm"></div>
        `;
    }

    function renderStopTab() {
        return `
            <button class="action-button" onclick="toggleForm('stopList')">–î–æ–±–∞–≤–∏—Ç—å –≤ —Å—Ç–æ–ø-–ª–∏—Å—Ç</button>
            <div class="list-container" id="stopList">
                ${items.length > 0 ? items.map((item) => `
                    <div class="list-item">
                        ${item.name} ${item.in_stop_list ? '(–≤ —Å—Ç–æ–ø-–ª–∏—Å—Ç–µ)' : ''}
                        <button onclick="toggleStop(${item.id})">${item.in_stop_list ? '–£–±—Ä–∞—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å'}</button>
                    </div>
                `).join('') : '<p>–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç</p>'}
            </div>
        `;
    }

    function renderDeleteTab() {
        return `
            <button class="action-button" onclick="toggleForm('deleteList')">–£–¥–∞–ª–∏—Ç—å</button>
            <div class="list-container" id="deleteList">
                ${items.length > 0 ? items.map((item) => `
                    <div class="list-item">
                        ${item.name}
                        <button onclick="deleteDish(${item.id})">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `).join('') : '<p>–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç</p>'}
            </div>
        `;
    }

    function renderHistoryTab() {
        return `
            <h1>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h1>
            <div class="orders-list">
                ${orders.length > 0 ? orders.map(order => `
                    <div class="order-item">
                        <div class="order-header" onclick="toggleOrderDetails(${order.id})">
                            <strong>–ó–∞–∫–∞–∑ #${order.id}</strong> –æ—Ç ${order.order_details.timestamp}
                            <span>–°—É–º–º–∞: ${order.order_details.total}‚ÇΩ</span>
                        </div>
                        <div class="order-details" id="order-details-${order.id}" style="display: none;">
                            <p><strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${order.customer.last_name} ${order.customer.first_name}</p>
                            <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${order.customer.phone}</p>
                            <p><strong>–ù–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã:</strong> ${order.customer.room_number || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                            <p><strong>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</strong> ${order.order_details.payment_method}</p>
                            <p><strong>–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> ${order.order_details.delivery_method}</p>
                            <p><strong>–ü–æ–∑–∏—Ü–∏–∏:</strong></p>
                            <ul>
                                ${order.order_details.items.map(item => `
                                    <li>${item.name} - ${item.quantity} —à—Ç. x ${item.price}‚ÇΩ = ${item.quantity * item.price}‚ÇΩ ${item.is_alcohol ? '(–∞–ª–∫–æ–≥–æ–ª—å)' : ''}</li>
                                `).join('')}
                            </ul>
                        </div>
                    </div>
                `).join('') : '<p>–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>'}
            </div>
        `;
    }

    function toggleOrderDetails(orderId) {
        const details = document.getElementById(`order-details-${orderId}`);
        details.style.display = details.style.display === 'none' ? 'block' : 'none';
        window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
    }

    function sendDishes() {
        const dishesText = newlyAddedItems.map(item =>
            `${item.name}\n` +
            `${item.category ? `–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${item.category}\n` : ''}` +
            `${item.description}\n–í–µ—Å: ${item.weight}\n` +
            `${item.portion_price ? `–¶–µ–Ω–∞ –ø–æ—Ä—Ü–∏–∏: ${item.portion_price}‚ÇΩ\n` : ''}` +
            `${item.bottle_price ? `–¶–µ–Ω–∞ –±—É—Ç—ã–ª–∫–∏: ${item.bottle_price}‚ÇΩ\n` : ''}` +
            `${item.is_alcohol ? '–ê–ª–∫–æ–≥–æ–ª—å\n' : ''}`
        ).join('\n---\n');
        window.Telegram.WebApp.showAlert('–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –±–ª—é–¥–∞:\n' + dishesText);
    }
</script>
</body>
</html>